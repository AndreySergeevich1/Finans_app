import{x,r as V,c as d,o as m,a as s,u as a,g as k,w as c,b as l,s as v,j as h,f as S,F as _,p as B,t as y,v as D,n as F,d as U}from"./app-B-v3dGX0.js";import{_ as N}from"./AuthenticatedLayout-BL5gwWCJ.js";import{D as q}from"./DebtForm-e2M2fYcg.js";import{_ as i,b as u,a as p}from"./TextInput-BCiOBFgQ.js";import{P as C}from"./PrimaryButton-DeN2JkVD.js";import"./SecondaryButton-CaNu0TH9.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const E={class:"py-8"},P={class:"max-w-2xl mx-auto sm:px-6 lg:px-8 space-y-6"},R={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-xl sm:rounded-lg p-6 md:p-8"},$={key:0,class:"bg-white dark:bg-gray-800 overflow-hidden shadow-xl sm:rounded-lg p-6 md:p-8"},j={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},I={key:0,disabled:""},M=["value"],O={class:"text-xs text-gray-500 mt-1"},T={class:"flex justify-end mt-4"},Q={__name:"Edit",props:{debt:{type:Object,required:!0},accounts:{type:Array,default:()=>[]}},setup(r){var g;const b=r,e=x({account_id:((g=b.accounts[0])==null?void 0:g.id)||null,amount:"",payment_date:new Date().toISOString().slice(0,10),notes:""}),w=()=>{e.post(route("debts.payments.store",b.debt.id),{preserveScroll:!0,onSuccess:()=>e.reset(),onError:n=>{console.error("Payment Error:",n)}})};V(!1),x({});function f(n){return n?new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:0}).format(n):"0 ₽"}return(n,t)=>(m(),d(_,null,[s(a(k),{title:"Долг: "+r.debt.lender_or_borrower},null,8,["title"]),s(N,null,{header:c(()=>t[4]||(t[4]=[])),default:c(()=>[l("div",E,[l("div",P,[l("div",R,[t[5]||(t[5]=l("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4"},"Детали долга/кредита",-1)),s(q,{debt:r.debt,submitRoute:"debts.update",cancelRoute:"debts.index",submitButtonText:"Сохранить изменения"},null,8,["debt"])]),r.debt.status==="active"||r.debt.status==="overdue"?(m(),d("div",$,[t[7]||(t[7]=l("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4"},"Добавить платеж",-1)),l("form",{onSubmit:h(w,["prevent"])},[l("div",j,[l("div",null,[s(i,{for:"payment_account_id",value:"Счет списания"}),S(l("select",{id:"payment_account_id","onUpdate:modelValue":t[0]||(t[0]=o=>a(e).account_id=o),required:"",class:"mt-1 block w-full form-select"},[r.accounts.length?v("",!0):(m(),d("option",I,"Нет доступных счетов")),(m(!0),d(_,null,B(r.accounts,o=>(m(),d("option",{key:o.id,value:o.id},y(o.name)+" ("+y(f(o.balance,o.currency))+") ",9,M))),128))],512),[[D,a(e).account_id]]),s(u,{class:"mt-2",message:a(e).errors.account_id},null,8,["message"])]),l("div",null,[s(i,{for:"payment_amount",value:"Сумма платежа"}),s(p,{id:"payment_amount",type:"number",step:"0.01",min:"0.01",max:r.debt.remaining_amount,class:"mt-1 block w-full",modelValue:a(e).amount,"onUpdate:modelValue":t[1]||(t[1]=o=>a(e).amount=o),required:"",placeholder:"0.00"},null,8,["max","modelValue"]),s(u,{class:"mt-2",message:a(e).errors.amount},null,8,["message"]),l("p",O,"Макс: "+y(f(r.debt.remaining_amount,r.debt.currency)),1)]),l("div",null,[s(i,{for:"payment_date",value:"Дата платежа"}),s(p,{id:"payment_date",type:"date",class:"mt-1 block w-full",modelValue:a(e).payment_date,"onUpdate:modelValue":t[2]||(t[2]=o=>a(e).payment_date=o),required:""},null,8,["modelValue"]),s(u,{class:"mt-2",message:a(e).errors.payment_date},null,8,["message"])]),l("div",null,[s(i,{for:"payment_notes",value:"Заметка (необязательно)"}),s(p,{id:"payment_notes",type:"text",class:"mt-1 block w-full",modelValue:a(e).notes,"onUpdate:modelValue":t[3]||(t[3]=o=>a(e).notes=o),placeholder:"Напр., Ежемесячный взнос"},null,8,["modelValue"]),s(u,{class:"mt-2",message:a(e).errors.notes},null,8,["message"])])]),l("div",T,[s(C,{class:F({"opacity-25":a(e).processing}),disabled:a(e).processing},{default:c(()=>t[6]||(t[6]=[U(" Зафиксировать платеж ")])),_:1},8,["class","disabled"])])],32)])):v("",!0)])])]),_:1})],64))}};export{Q as default};
