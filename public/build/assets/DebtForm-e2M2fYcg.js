import{k as U,x as S,e as B,H as q,c as p,o as _,b as o,s as g,a as s,f as c,v as b,u as t,w as f,d as y,S as R,t as D,n as T,j}from"./app-B-v3dGX0.js";import{_ as n,b as u,a as m}from"./TextInput-BCiOBFgQ.js";import{P as N}from"./PrimaryButton-DeN2JkVD.js";import{_ as P}from"./SecondaryButton-CaNu0TH9.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";const C={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},M={key:0,class:"text-xs text-gray-500 mt-1"},O={key:0},E={class:"md:col-span-2"},F={class:"flex items-center justify-end space-x-3 pt-6 mt-6 border-t border-gray-200 dark:border-gray-700"},z={__name:"DebtForm",props:{debt:{type:Object,default:null},submitRoute:{type:String,required:!0},cancelRoute:{type:String,required:!0},submitButtonText:{type:String,default:"Сохранить"}},setup(V){const r=V,{submitRoute:v,cancelRoute:w,submitButtonText:k}=r,d=U(()=>!!r.debt),e=S({_method:"POST",type:"debt_taken",lender_or_borrower:"",initial_amount:"",remaining_amount:"",currency:"RUB",interest_rate:"",interest_type:null,due_date:null,status:"active",notes:""});B(()=>{var i;d.value?Object.assign(e,{_method:"PUT",type:r.debt.type,lender_or_borrower:r.debt.lender_or_borrower,initial_amount:r.debt.initial_amount,remaining_amount:r.debt.remaining_amount,currency:r.debt.currency,interest_rate:r.debt.interest_rate,interest_type:r.debt.interest_type,due_date:((i=r.debt.due_date)==null?void 0:i.slice(0,10))??null,status:r.debt.status,notes:r.debt.notes||""}):e.remaining_amount=e.initial_amount}),q(()=>e.initial_amount,i=>{d.value||(e.remaining_amount=i)});const x=()=>{const i=d.value?{debt:r.debt.id}:{},l={preserveScroll:!0};d.value?e.put(route(v,i),l):e.transform(a=>({...a,_method:void 0,remaining_amount:void 0})).post(route(v,i),l)};return(i,l)=>(_(),p("form",{onSubmit:j(x,["prevent"]),class:"space-y-6"},[o("div",C,[o("div",null,[s(n,{for:"type",value:"Тип"}),c(o("select",{id:"type","onUpdate:modelValue":l[0]||(l[0]=a=>t(e).type=a),required:"",class:"mt-1 block w-full form-select"},l[10]||(l[10]=[o("option",{value:"loan"},"Кредит банка",-1),o("option",{value:"microloan"},"Микрокредит",-1),o("option",{value:"debt_taken"},"Я взял в долг",-1),o("option",{value:"debt_given"},"Я дал в долг",-1)]),512),[[b,t(e).type]]),s(u,{class:"mt-2",message:t(e).errors.type},null,8,["message"])]),o("div",null,[s(n,{for:"lender_or_borrower",value:"Кредитор / Заемщик"}),s(m,{id:"lender_or_borrower",modelValue:t(e).lender_or_borrower,"onUpdate:modelValue":l[1]||(l[1]=a=>t(e).lender_or_borrower=a),required:"",placeholder:"Название банка или имя",class:"mt-1 block w-full"},null,8,["modelValue"]),s(u,{class:"mt-2",message:t(e).errors.lender_or_borrower},null,8,["message"])]),o("div",null,[s(n,{for:"initial_amount",value:"Начальная сумма"}),s(m,{id:"initial_amount",type:"number",step:"0.01",modelValue:t(e).initial_amount,"onUpdate:modelValue":l[2]||(l[2]=a=>t(e).initial_amount=a),disabled:d.value,placeholder:"10000.00",class:"mt-1 block w-full"},null,8,["modelValue","disabled"]),s(u,{class:"mt-2",message:t(e).errors.initial_amount},null,8,["message"]),d.value?(_(),p("p",M," Начальная сумма не редактируется. ")):g("",!0)]),d.value?(_(),p("div",O,[s(n,{for:"remaining_amount",value:"Оставшаяся сумма"}),s(m,{id:"remaining_amount",type:"number",step:"0.01",modelValue:t(e).remaining_amount,"onUpdate:modelValue":l[3]||(l[3]=a=>t(e).remaining_amount=a),required:"",class:"mt-1 block w-full"},null,8,["modelValue"]),s(u,{class:"mt-2",message:t(e).errors.remaining_amount},null,8,["message"]),l[11]||(l[11]=o("p",{class:"text-xs text-gray-500 mt-1"}," Обновляется автоматически при платежах или вручную. ",-1))])):g("",!0),o("div",null,[s(n,{for:"currency",value:"Валюта"}),s(m,{id:"currency",modelValue:t(e).currency,"onUpdate:modelValue":l[4]||(l[4]=a=>t(e).currency=a),required:"",placeholder:"RUB",maxlength:"3",class:"mt-1 block w-full"},null,8,["modelValue"]),s(u,{class:"mt-2",message:t(e).errors.currency},null,8,["message"])]),o("div",null,[s(n,{for:"interest_rate",value:"Ставка, % годовых"}),s(m,{id:"interest_rate",type:"number",step:"0.01",modelValue:t(e).interest_rate,"onUpdate:modelValue":l[5]||(l[5]=a=>t(e).interest_rate=a),placeholder:"15.5",class:"mt-1 block w-full"},null,8,["modelValue"]),s(u,{class:"mt-2",message:t(e).errors.interest_rate},null,8,["message"])]),o("div",null,[s(n,{for:"interest_type",value:"Тип %"}),c(o("select",{id:"interest_type","onUpdate:modelValue":l[6]||(l[6]=a=>t(e).interest_type=a),class:"mt-1 block w-full form-select"},l[12]||(l[12]=[o("option",{value:null},"-- Не указан --",-1),o("option",{value:"simple"},"Простой",-1),o("option",{value:"compound"},"Сложный",-1)]),512),[[b,t(e).interest_type]]),s(u,{class:"mt-2",message:t(e).errors.interest_type},null,8,["message"])]),o("div",null,[s(n,{for:"due_date",value:"Срок погашения"}),s(m,{id:"due_date",type:"date",modelValue:t(e).due_date,"onUpdate:modelValue":l[7]||(l[7]=a=>t(e).due_date=a),class:"mt-1 block w-full"},null,8,["modelValue"]),s(u,{class:"mt-2",message:t(e).errors.due_date},null,8,["message"])]),o("div",null,[s(n,{for:"status",value:"Статус"}),c(o("select",{id:"status","onUpdate:modelValue":l[8]||(l[8]=a=>t(e).status=a),required:"",class:"mt-1 block w-full form-select"},l[13]||(l[13]=[o("option",{value:"active"},"Активен",-1),o("option",{value:"paid"},"Погашен",-1),o("option",{value:"overdue"},"Просрочен",-1),o("option",{value:"extended"},"Продлен",-1)]),512),[[b,t(e).status]]),s(u,{class:"mt-2",message:t(e).errors.status},null,8,["message"])]),o("div",E,[s(n,{for:"notes",value:"Заметки"}),s(m,{id:"notes",type:"text",modelValue:t(e).notes,"onUpdate:modelValue":l[9]||(l[9]=a=>t(e).notes=a),placeholder:"Доп. информация...",class:"mt-1 block w-full"},null,8,["modelValue"]),s(u,{class:"mt-2",message:t(e).errors.notes},null,8,["message"])])]),o("div",F,[s(t(R),{href:i.route(t(w))},{default:f(()=>[s(P,{type:"button"},{default:f(()=>l[14]||(l[14]=[y("Отмена")])),_:1})]),_:1},8,["href"]),s(N,{disabled:t(e).processing,class:T({"opacity-25":t(e).processing})},{default:f(()=>[y(D(t(k)),1)]),_:1},8,["disabled","class"])])],32))}},K=$(z,[["__scopeId","data-v-5967863e"]]);export{K as D};
